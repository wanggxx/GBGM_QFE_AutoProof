x:x_i in Z^n.
y:y_j in Z^n.
q:q_ij in Z^(n*n).
var: d1,d2,s1,s2,s3,s4,t1,t2,t3,t4,w1,w2,w3,w4,w5,w6,w7,w8,l,m1,m2,m3,m4,m5,m6,m7,m8,m9 in Zp; a11_i,a12_i,b11_j,b12_j in Zp^n.
PublicKey:[a11_i*(-(m6*m8 - m5*m9)*m1 + (m3*m8 - m2*m9)*m4 - (m3*m5 - m2*m6)*m7)]_1,[a12_i*(-(m6*m8 - m5*m9)*m1 + (m3*m8 - m2*m9)*m4 - (m3*m5 - m2*m6)*m7)]_1 in G1^n;[d1*(-(m6*m8 - m5*m9)*m1 + (m3*m8 - m2*m9)*m4 - (m3*m5 - m2*m6)*m7)]_1,[d2*(-(m6*m8 - m5*m9)*m1 + (m3*m8 - m2*m9)*m4 - (m3*m5 - m2*m6)*m7)]_1,[(w1*d1+w2*d2)*(-(m6*m8 - m5*m9)*m1 + (m3*m8 - m2*m9)*m4 - (m3*m5 - m2*m6)*m7)]_1,[(w3*d1+w4*d2)*(-(m6*m8 - m5*m9)*m1 + (m3*m8 - m2*m9)*m4 - (m3*m5 - m2*m6)*m7)]_1,[(w5*d1+w6*d2)*(-(m6*m8 - m5*m9)*m1 + (m3*m8 - m2*m9)*m4 - (m3*m5 - m2*m6)*m7)]_1,[(w7*d1+w8*d2)*(-(m6*m8 - m5*m9)*m1 + (m3*m8 - m2*m9)*m4 - (m3*m5 - m2*m6)*m7)]_1 in G1;[b11_j]_2,[b12_j]_2 in G2^n.
Enc:[x_i*(-m6*m8+m5*m9)+(s1*a11_i+s3*a12_i)*(m3*m8-m2*m9)+(s2*a11_i+s4*a12_i)*(-m3*m5+m2*m6)]_1,[x_i*(m6*m7-m4*m9)+(s1*a11_i+s3*a12_i)*(-m3*m7+m1*m9)+(s2*a11_i+s4*a12_i)*(m3*m4-m1*m6)]_1,[x_i*(-m5*m7+m4*m8)+(s1*a11_i+s3*a12_i)*(m2*m7-m1*m8)+(s2*a11_i+s4*a12_i)*(-m2*m4+m1*m5)]_1 in G1^n;[l*d1*(-(m6*m8 - m5*m9)*m1 + (m3*m8 - m2*m9)*m4 - (m3*m5 - m2*m6)*m7)]_1,[l*d2*(-(m6*m8 - m5*m9)*m1 + (m3*m8 - m2*m9)*m4 - (m3*m5 - m2*m6)*m7)]_1,[(s1*t1+s2*t2+l*w1*d1+l*w2*d2)*(-(m6*m8 - m5*m9)*m1 + (m3*m8 - m2*m9)*m4 - (m3*m5 - m2*m6)*m7)]_1,[(s1*t3+s2*t4+l*w3*d1+l*w4*d2)*(-(m6*m8 - m5*m9)*m1 + (m3*m8 - m2*m9)*m4 - (m3*m5 - m2*m6)*m7)]_1,[(s3*t1+s4*t2+l*w5*d1+l*w6*d2)*(-(m6*m8 - m5*m9)*m1 + (m3*m8 - m2*m9)*m4 - (m3*m5 - m2*m6)*m7)]_1,[(s3*t3+s4*t4+l*w7*d1+l*w8*d2)*(-(m6*m8 - m5*m9)*m1 + (m3*m8 - m2*m9)*m4 - (m3*m5 - m2*m6)*m7)]_1 in G1;[y_j*m1+(b11_j*t1+b12_j*t3)*m4+(b11_j*t2+b12_j*t4)*m7]_2,[y_j*m2+(b11_j*t1+b12_j*t3)*m5+(b11_j*t2+b12_j*t4)*m8]_2,[y_j*m3+(b11_j*t1+b12_j*t3)*m6+(b11_j*t2+b12_j*t4)*m9]_2 in G2^n.
KeyGen:[q_ij*a11_i*b11_j]_2,[q_ij*a11_i*b12_j]_2,[q_ij*a12_i*b11_j]_2,[q_ij*a12_i*b12_j]_2,[w1*q_ij*a11_i*b11_j+w3*q_ij*a11_i*b12_j+w5*q_ij*a12_i*b11_j+w7*q_ij*a12_i*b12_j]_2,[w2*q_ij*a11_i*b11_j+w4*q_ij*a11_i*b12_j+w6*q_ij*a12_i*b11_j+w8*q_ij*a12_i*b12_j]_2 in G2.
offset: -(m6*m8 - m5*m9)*m1 + (m3*m8 - m2*m9)*m4 - (m3*m5 - m2*m6)*m7 in Zp.